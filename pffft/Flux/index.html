<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Flux (pffft.Flux)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">pffft</a> &#x00BB; Flux</nav><h1>Module <code>Flux</code></h1><p>Opérations sur les flux.</p><p>Un flux est un générateur paresseux : cela permet de produire une quantité infinie d'information (par exemple une suite de nombres ou de lettres) avec une empreinte mémoire légère.</p><nav class="toc"><ul><li><a href="#manipulations-élémentaires">Manipulations élémentaires</a></li><li><a href="#filtrage-et-modifications">Filtrage et modifications</a></li><li><a href="#création-d'un-flux">Création d'un flux</a></li><li><a href="#opérations-supplémentaires">Opérations supplémentaires</a></li></ul></nav></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> <span>'a t</span></code></dt><dd><p>Un flux de <code>'a</code>.</p></dd></dl><section><header><h2 id="manipulations-élémentaires"><a href="#manipulations-élémentaires" class="anchor"></a>Manipulations élémentaires</h2></header><dl><dt class="spec value" id="val-empty"><a href="#val-empty" class="anchor"></a><code><span class="keyword">val</span> empty : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p>Flux vide, qui se termine à la lecture du premier élément.</p></dd></dl><dl><dt class="spec value" id="val-cons"><a href="#val-cons" class="anchor"></a><code><span class="keyword">val</span> cons : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>cons v flux</code> ajoute <code>v</code> en tête du flux <code>flux</code>.</p></dd></dl><dl><dt class="spec value" id="val-uncons"><a href="#val-uncons" class="anchor"></a><code><span class="keyword">val</span> uncons : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span>)</span> option</span></code></dt><dd><p><code>uncons flux</code> récupère le premier élément du flux <code>flux</code>, sous la forme d'une option :</p><ul><li><code>None</code> : le flux est terminé.</li><li><code>Some (v, suite)</code> : <code>v</code> est la valeur retirée du flux, et <code>suite</code> est la suite du flux.</li></ul></dd></dl><dl><dt class="spec value" id="val-append"><a href="#val-append" class="anchor"></a><code><span class="keyword">val</span> append : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>append flux1 flux2</code> produit un unique flux qui est la concaténation de <code>flux1</code> puis <code>flux2</code>. Si <code>flux1</code> ne termine pas, les éléments de <code>flux2</code> ne seront jamais lu dans flux produit.</p></dd></dl></section><section><header><h2 id="filtrage-et-modifications"><a href="#filtrage-et-modifications" class="anchor"></a>Filtrage et modifications</h2></header><dl><dt class="spec value" id="val-filter"><a href="#val-filter" class="anchor"></a><code><span class="keyword">val</span> filter : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> bool)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>filter pr flux</code> produit un flux sans les éléments du flux <code>flux</code> valant <code>false</code> au prédicat <code>pr</code>. L'ordre des éléments est conservé.</p></dd></dl><dl><dt class="spec value" id="val-map"><a href="#val-map" class="anchor"></a><code><span class="keyword">val</span> map : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>map f flux</code> applique la fonction <code>f</code> à tous les éléments du flux <code>flux</code>, pour produire un nouveau flux.</p></dd></dl><dl><dt class="spec value" id="val-apply"><a href="#val-apply" class="anchor"></a><code><span class="keyword">val</span> apply : <span><span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>apply f_flux v_flux</code> applique un flux de fonctions <code>f_flux</code> à un flux d'éléments <code>v_flux</code> : la première fonction extraite de <code>f_flux</code> est appelée sur le premier élément extrait de <code>v_flux</code>, la seconde sur le second... pour produire un nouveau flux.</p><p>Par exemple</p><pre><code class="ml">let flux_fonctions = Flux.unfold (fun i -&gt; Some(fun n -&gt; n + i, i + 1)) 0 in
let flux_entiers = Flux.unfold (fun n -&gt; Some(n, n + 1)) 0 in
let flux = Flux.apply flux_fonctions flux_entiers</code></pre><p>produit le flux des entiers pairs.</p><p>Le flux produit se termine lorsqu'un des deux flux se termine.</p></dd></dl></section><section><header><h2 id="création-d'un-flux"><a href="#création-d'un-flux" class="anchor"></a>Création d'un flux</h2></header><dl><dt class="spec value" id="val-constant"><a href="#val-constant" class="anchor"></a><code><span class="keyword">val</span> constant : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>constant v</code> produit un flux constant et infini de <code>v</code>.</p></dd></dl><dl><dt class="spec value" id="val-unfold"><a href="#val-unfold" class="anchor"></a><code><span class="keyword">val</span> unfold : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'b</span> * <span class="type-var">'a</span>)</span> option</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>unfold f x</code> crée un flux à partir de la fonction <code>f</code> et de son argument initial <code>x</code>.</p><p>La fonction <code>f</code> renvoie une <code>option</code> :</p><ul><li>Si c'est <code>None</code>, le flux s'arrête.</li><li>Si c'est <code>Some (v, x)</code> alors <code>v</code> sera la valeur ajoutée au flux, et <code>x</code> l'argument de <code>f</code> pour générer la prochaine valeur du flux.</li></ul><p>Par exemple,</p><pre><code class="ml">Flux.unfold (fun x -&gt; if x &lt;= 100 then Some (x, x + 2) else None) 50 </code></pre><p>est le flux des entiers pairs de 50 à 100 inclus.</p><p>On peut rendre ce flux infini,</p><pre><code class="ml">Flux.unfold (fun x -&gt; Some (x, x + 2)) 50 </code></pre><p>mais attention à la terminaison du programme.</p></dd></dl></section><section><header><h2 id="opérations-supplémentaires"><a href="#opérations-supplémentaires" class="anchor"></a>Opérations supplémentaires</h2></header><dl><dt class="spec value" id="val-map2"><a href="#val-map2" class="anchor"></a><code><span class="keyword">val</span> map2 : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'c</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>map2 f flux1 flux2</code> est similaire à <a href="index.html#val-map"><code>map</code></a> mais la fonction <code>f</code> prend deux arguments, et par conséquent <code>map2</code> prend deux flux en argument. Le flux produit se termine lorsque <code>flux1</code> ou <code>flux2</code> se termine.</p><p>Par exemple, si <code>flux1</code> et <code>flux2</code> sont deux flux d'entiers, on peut additionner leurs éléments deux à deux :</p><pre><code class="ml">Flux.map2 (fun a b -&gt; a + b) flux1 flux2 </code></pre></dd></dl></section></div></body></html>