<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Pffft (pffft.Pffft)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">pffft</a> &#x00BB; Pffft</nav><h1>Module <code>Pffft</code></h1><p>Programmation fonctionnelle : un fantastique framework de test.</p></header><dl><dt class="spec value" id="val-assumption"><a href="#val-assumption" class="anchor"></a><code><span class="keyword">val</span> assumption : <span>(unit <span>&#45;&gt;</span> bool)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Filtre et ne continue que les executions qui vérifient le prédicat passé en paramètre. Les autres exécutions sont simplement arrêtées et déclarées valides. Ceci correspond à la sémantique d'une précondition, i.e. on n'exécute un programme que si sa précondition est vraie, i.e. on ignore les autres exécutions.</p></dd></dl><dl><dt class="spec value" id="val-assertion"><a href="#val-assertion" class="anchor"></a><code><span class="keyword">val</span> assertion : <span>(unit <span>&#45;&gt;</span> bool)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Filtre et ne continue que les executions qui vérifient le prédicat passé en paramètre. Les autres exécutions sont simplement arrêtées et déclarées invalides. Ceci correspond à la sémantique d'une postcondition, i.e. on ne valide l'exéecution que si la postcondition est vraie, i.e. les autres executions sont invalides et correspondent à une erreur.</p></dd></dl><dl><dt class="spec value" id="val-miracle"><a href="#val-miracle" class="anchor"></a><code><span class="keyword">val</span> miracle : unit <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Interrompt l'exécution et la rend valide (sans renvoyer de valeur).</p></dd></dl><dl><dt class="spec value" id="val-failure"><a href="#val-failure" class="anchor"></a><code><span class="keyword">val</span> failure : unit <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Interrompt l'exécution et la rend invalide (sans renvoyer de valeur).</p></dd></dl><dl><dt class="spec value" id="val-forall_bool"><a href="#val-forall_bool" class="anchor"></a><code><span class="keyword">val</span> forall_bool : unit <span>&#45;&gt;</span> bool</code></dt><dd><p>Forke l'exécution courante en deux versions. Dans chacune de ces versions, <code>forall_bool</code> renvoie un booleen différent. L'exécution parente est valide si et seulement si les deux exécutions filles le sont.</p></dd></dl><dl><dt class="spec value" id="val-forsome_bool"><a href="#val-forsome_bool" class="anchor"></a><code><span class="keyword">val</span> forsome_bool : unit <span>&#45;&gt;</span> bool</code></dt><dd><p>Forke l'exécution courante en deux versions. Dans chacune de ces versions, <code>forsome_bool</code> renvoie un booleen différent. L'exécution parente est valide si et seulement si au moins une des deux exécutions filles le sont.</p></dd></dl><dl><dt class="spec value" id="val-forall"><a href="#val-forall" class="anchor"></a><code><span class="keyword">val</span> forall : <span><span class="type-var">'a</span> <a href="../Flux/index.html#type-t">Flux.t</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Genéralise <code>forall_bool</code> et forke l'exécution courante en autant de versions qu'il y a d'éléments dans le flux.</p></dd></dl><dl><dt class="spec value" id="val-forsome"><a href="#val-forsome" class="anchor"></a><code><span class="keyword">val</span> forsome : <span><span class="type-var">'a</span> <a href="../Flux/index.html#type-t">Flux.t</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Genéralise <code>forsome_bool</code> et forke l'exécution courante en autant de versions qu'il y a d'éléments dans le flux.</p></dd></dl><dl><dt class="spec value" id="val-foratleast"><a href="#val-foratleast" class="anchor"></a><code><span class="keyword">val</span> foratleast : int <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../Flux/index.html#type-t">Flux.t</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Forke de la même façon l'exécution courante. L'exécution parente est valide si est seulement si au moins <code>n</code> exécutions filles le sont. On a <code>Pffft.forsome = Pffft.foratleast 1</code>.</p></dd></dl><dl><dt class="spec value" id="val-check"><a href="#val-check" class="anchor"></a><code><span class="keyword">val</span> check : <span>(unit <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> bool</code></dt><dd><p>Exécute un programme instrumenté avec les primitives ci-dessus. Le resultat booléen représente la validité de l'exécution et permet de s'interfacer avec <code>let%test</code> de <code>ppx_inline_test</code>.</p></dd></dl><dl><dt class="spec value" id="val-on_success"><a href="#val-on_success" class="anchor"></a><code><span class="keyword">val</span> on_success : <span>(unit <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Exécute la fonction passée en paramètre si et seulement si l'exécution courante est valide.</p></dd></dl><dl><dt class="spec value" id="val-on_failure"><a href="#val-on_failure" class="anchor"></a><code><span class="keyword">val</span> on_failure : <span>(unit <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Exécute la fonction passée en paramètre si et seulement si l'exécution courante est invalide.</p></dd></dl><dl><dt class="spec value" id="val-forall_length"><a href="#val-forall_length" class="anchor"></a><code><span class="keyword">val</span> forall_length : <span>int <a href="../Flux/index.html#type-t">Flux.t</a></span> <span>&#45;&gt;</span> <span>(unit <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> list</span></code></dt><dd><p><code>forall_length lengths values</code> produit des listes de longueur issue du flux <code>lengths</code> avec les valeurs produites par <code>values</code>, et vérifie que la suite de l'exécution est valide pour toutes les listes produites.</p><p>On peut vérifier que sur les listes de longueur impaire contenant des <code>'a'</code> ou des <code>'b'</code>, il y a toujours un nombre pair d'un des deux éléments :</p><pre><code class="ml">let rec count l x =
  match l with
  | [] -&gt; 0
  | t :: q when t = x -&gt; 1 + count q x
  | _ :: q -&gt; count q x
in
let l =
  forall_length
    (Flux.unfold (fun x -&gt; if x &lt;= 10 then Some (x, x + 2) else None) 1)
    (fun () -&gt; forall Flux.(cons 'a' (cons 'b' empty)))
in
assertion (fun () -&gt; count l 'a' mod 2 = 0 || count l 'b' mod 2 = 0)</code></pre></dd></dl><dl><dt class="spec value" id="val-forsome_length"><a href="#val-forsome_length" class="anchor"></a><code><span class="keyword">val</span> forsome_length : <span>int <a href="../Flux/index.html#type-t">Flux.t</a></span> <span>&#45;&gt;</span> <span>(unit <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> list</span></code></dt><dd><p><code>forsome_length lengths values</code> produit des listes de longueur issue du flux <code>lengths</code> avec les valeurs produites par <code>values</code>, et vérifie que la suite de l'exécution est valide pour au moins une des listes produites.</p></dd></dl><dl><dt class="spec value" id="val-foratleast_length"><a href="#val-foratleast_length" class="anchor"></a><code><span class="keyword">val</span> foratleast_length : int <span>&#45;&gt;</span> <span>int <a href="../Flux/index.html#type-t">Flux.t</a></span> <span>&#45;&gt;</span> <span>(unit <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> list</span></code></dt><dd><p><code>foratleast_length n lengths values</code> produit des listes de longueur issue du flux <code>lengths</code> avec les valeurs produites par <code>values</code>, et vérifie que la suite de l'exécution est valide pour au moins <code>n</code> listes produites. On a <code>Pffft.forsome_length = Pffft.foratleast_length 1</code>.</p></dd></dl></div></body></html>